#!/bin/bash

# ะกะบัะธะฟั ะดะปั ะณะตะฝะตัะฐััั ะฝะพะฒะพะณะพ ะฟะฐัะพะปั ะดะปั ะฑะฐะทะพะฒะพั HTTP ะฐะฒัะพัะธะทะฐััั

echo "๐ ะะตะฝะตัะฐััั ะฝะพะฒะพะณะพ ะฟะฐัะพะปั ะดะปั ะฑะฐะทะพะฒะพั ะฐะฒัะพัะธะทะฐััั"
echo ""

# ะะฐะฟะธั ะฝะพะฒะพะณะพ ะฟะฐัะพะปั
read -s -p "ะะฒะตะดััั ะฝะพะฒะธะน ะฟะฐัะพะปั: " password
echo ""
read -s -p "ะัะดัะฒะตัะดััั ะฟะฐัะพะปั: " password_confirm
echo ""

# ะะตัะตะฒััะบะฐ ัะฟัะฒะฟะฐะดัะฝะฝั ะฟะฐัะพะปัะฒ
if [ "$password" != "$password_confirm" ]; then
    echo "โ ะะฐัะพะปั ะฝะต ัะฟัะฒะฟะฐะดะฐััั!"
    exit 1
fi

# ะะตะฝะตัะฐััั ัะตัั ะฟะฐัะพะปั
hashed_password=$(openssl passwd -apr1 "$password")

# ะกัะฒะพัะตะฝะฝั ะฝะพะฒะพะณะพ ัะฐะนะปั htpasswd
echo "admin:$hashed_password" > docker/nginx/htpasswd

echo "โ ะะฐัะพะปั ััะฟััะฝะพ ะพะฝะพะฒะปะตะฝะพ!"
echo "๐ค ะะพะณัะฝ: admin"
echo "๐ ะะฐัะพะปั: (ะฒะฒะตะดะตะฝะธะน ะฒะฐะผะธ)"
echo ""
echo "๐ ะคะฐะนะป htpasswd ะพะฝะพะฒะปะตะฝะพ: docker/nginx/htpasswd"
echo ""
echo "๐ ะะตัะตะทะฐะฟัััััั ัะตัะฒััะธ ะดะปั ะทะฐััะพััะฒะฐะฝะฝั ะทะผัะฝ:"
echo "   ./manage.sh restart" 